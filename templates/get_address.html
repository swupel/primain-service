{% extends "base.html" %}
{% block title %}Primain Address{% endblock %}
{% block content %}
<header>
    <h1>Primain Address</h1>
</header>
<main>
    <form id="primainForm">
        <label for="primainName">Enter Primain Name:</label>
        <input type="text" id="primainName" name="primainName" required>
        <button type="submit" class="button">Get Address</button>
    </form>

    <div id="messageContainer" class="message" style="display: none;"></div>

    <div id="addressDisplay" style="display: none; text-align: center;">
        <div id="addressBox" style="background-color: #121212; color: #ffffff; border: 1px solid #5af0b9; border-radius: 5px; padding: 15px; margin-bottom: 10px; display: inline-block;">
            <div style="display: flex; align-items: center; margin-bottom: 10px;">
                <div id="networkLogoContainer" style="margin-right: 8px;"></div>
                <span id="addressValue" style="font-size: 18px;"></span>
            </div>
            <button id="copyAddressButton" class="button" onclick="copyAddress()" style="display: block; margin: 0 auto;">Copy Address</button>
        </div>
    </div>
    <a href="/home" class="back-button">Home</a>
</main>
<script>
    const networks = [
        { id: '1', name: 'Ethereum', logo: 'static/ethereum-eth-logo.png' },
        { id: '137', name: 'Polygon', logo: 'static/polygon-matic-logo.png' },
        { id: '56', name: 'Binance Smart Chain', logo: 'static/bnb-bnb-logo.png' },
        { id: '43114', name: 'Avalanche', logo: 'static/avalanche-avax-logo.png' },
        { id: '250', name: 'Fantom', logo: 'static/fantom-ftm-logo.png' },
        { id: '42161', name: 'Arbitrum', logo: 'static/arbitrum-arb-logo.png' },
        { id: '10', name: 'Optimism', logo: 'static/optimism-ethereum-op-logo.png' },
        { id: '61', name: 'Harmony', logo: 'static/harmony-one-logo.png' },
        { id: '25', name: 'Cronos', logo: 'static/cronos-cro-logo.png' },
        { id: '42220', name: 'Celo', logo: 'static/celo-celo-logo.png' },
        { id: '0', name: 'Bitcoin', logo: 'static/bitcoin-btc-logo.png' },
        { id: '101', name: 'Solana', logo: 'static/solana-sol-logo.png' },
        { id: 'tether', name: 'Tether', logo: 'static/tether-usdt-logo.png' },
        { id: '6', name: 'USD Coin', logo: 'static/usd-coin-usdc-logo.png' },
        { id: 'XRP', name: 'XRP', logo: 'static/xrp-xrp-logo.png' },
        { id: 'Dogecoin', name: 'Dogecoin', logo: 'static/dogecoin-doge-logo.png' },
        { id: 'TRON', name: 'TRON', logo: 'static/tron-trx-logo.png' },
        { id: '1001', name: 'TONCOIN', logo: 'static/toncoin-ton-logo.png' },
        { id: '3', name: 'Cardano', logo: 'static/cardano-ada-logo.png' },
        { id: '0xShiba', name: 'Shiba INU', logo: 'static/shiba-inu-shib-logo.png' },
        { id: '145', name: 'Bitcoin Cash', logo: 'static/bitcoin-cash-bch-logo.png' },
        { id: '1', name: 'Chainlink', logo: 'static/chainlink-link-logo.png' },
        { id: '354', name: 'Polkadot', logo: 'static/polkadot-new-dot-logo.png' },
        { id: '0xDAI', name: 'DAI', logo: 'static/multi-collateral-dai-dai-logo.png' },
        { id: '0xLEO', name: 'LEO', logo: 'static/unus-sed-leo-leo-logo.png' },
        { id: '2', name: 'Litecoin', logo: 'static/litecoin-ltc-logo.png' },
        { id: '245', name: 'NEAR', logo: 'static/near-protocol-near-logo.png' },
        { id: '0xUniswap', name: 'Uniswap', logo: 'static/uniswap-uni-logo.png' },
        { id: '128', name: 'Monero', logo: 'static/monero-xmr-logo.png' },
        { id: '61', name: 'Ethereum Classic', logo: 'static/ethereum-classic-etc-logo.png' },
        { id: '461', name: 'Filecoin', logo: 'static/filecoin-fil-logo.png' },
        { id: '0xHedera', name: 'Hedera', logo: 'static/hedera-hbar-logo.png' },
        { id: '394', name: 'Cosmos', logo: 'static/cosmos-atom-logo.png' },
        { id: '123', name: 'Arweave', logo: 'static/arweave-ar-logo.png' },
        { id: '65535', name: 'Helium', logo: 'static/helium-hnt-logo.png' },
        { id: '500', name: 'Theta', logo: 'static/theta-network-theta-logo.png' },
        { id: '60', name: 'EOS', logo: 'static/eos-eos-logo.png' },
        { id: '89', name: 'NEO', logo: 'static/neo-neo-logo.png' },
        { id: '133', name: 'Zcash', logo: 'static/zcash-zec-logo.png' },
        { id: 'QNT', name: 'Quant', logo: 'static/quant-qnt-logo.png' },
    ];
        document.getElementById('primainForm').addEventListener('submit', function(event) {
            event.preventDefault();
            var primainName = document.getElementById('primainName').value;
            fetch('/', {
                method: 'POST',
                body: new URLSearchParams({ primain_name: primainName }),
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded'
                }
            })
            .then(response => response.json())
            .then(data => {
                var messageContainer = document.getElementById('messageContainer');
                var addressDisplay = document.getElementById('addressDisplay');
                var addressValue = document.getElementById('addressValue');
    
                if (data.error) {
                    messageContainer.textContent = data.error;
                    messageContainer.className = 'message danger';
                    messageContainer.style.display = 'block';
                    addressDisplay.style.display = 'none';
                } else {
                    addressValue.textContent = data.address;
    
                    // Clear previous network logos
                    var networkLogoContainer = document.getElementById('networkLogoContainer');
                    networkLogoContainer.innerHTML = '';
    
                    // Get network logo based on the network name from data
                    const network = networks.find(n => n.name.toLowerCase() === data.network.toLowerCase());
                    if (network) {
                        var networkLogo = document.createElement('img');
                        networkLogo.src = network.logo;
                        networkLogo.alt = network.name;
                        networkLogo.style.width = '30px';
                        networkLogo.style.height = '30px';
                        networkLogo.title = `This Address is only valid on the ${network.name} Mainnet`;
                        networkLogoContainer.appendChild(networkLogo);
                    } else {
                        console.error(`Network not found: ${data.network}`);
                        networkLogoContainer.innerHTML = `<span>Network not recognized: ${data.network}</span>`;
                    }
    
                    addressDisplay.style.display = 'block';
                    messageContainer.style.display = 'none';
                }
            })
            .catch(error => {
                var messageContainer = document.getElementById('messageContainer');
                messageContainer.textContent = 'An error occurred. Please try again.';
                messageContainer.className = 'message danger';
                messageContainer.style.display = 'block';
                addressDisplay.style.display = 'none';
                console.error('Error:', error);
            });
        });
    
        function copyAddress() {
            var addressValue = document.getElementById('addressValue');
            var range = document.createRange();
            range.selectNode(addressValue);
            window.getSelection().removeAllRanges();
            window.getSelection().addRange(range);
            document.execCommand('copy');
            window.getSelection().removeAllRanges();
            alert('Address copied to clipboard');
        }
    </script>
{% endblock %}
