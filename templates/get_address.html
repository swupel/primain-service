{% extends "base.html" %}
{% block title %}Primain Address{% endblock %}
{% block content %}
<header>
    <h1>Primain Address</h1>
</header>
<main>
    <form id="primainForm">
        <label for="primainName">Enter Primain Name:</label>
        <input type="text" id="primainName" name="primainName" required size=40>
        <button type="submit" class="button">Get Addresses</button>
    </form>

    <!-- Center the FAQ link -->
    <div style="text-align: center;">
        <p><a href="{{ url_for('about') }}">What Are Primains? Check Out Our FAQs</a></p>
    </div>

    <div id="messageContainer" class="message" style="display: none;"></div>

    <div id="addressesDisplay" style="display: none; text-align: center;">
        <!-- Container for displaying addresses dynamically -->
    </div>

    <div id="dynamicBoxes" class="dynamic-boxes-container">
        <div class="dynamic-box">
            <h2>Say Goodbye to complicated long wallet adddresses!</h2>
            <p>Just Register a Primain and Receive funds under your personal, company or even user name!</p>
        </div>
        <div class="dynamic-box">
            <h2>Try It Out</h2>
            <p>Wanna say Goodbye to antiquated old addresses? Click here:</p>
            <a href="/signup" class="button-link">
                <button class="button">Get your very own Primain</button>
            </a>
        </div>
        <div class="dynamic-box">
            <h2>Too good to be true?</h2>
            <p>If you want more information on what makes Primains work, check our <a href="https://example.com/patent">patent</a> and prepare to be amazed</p>
        </div>
        <div class="dynamic-box">
            <h2>Become an Affiliate</h2>
            <p>Join our <a href="https://example.com/affiliate"> affiliate program </a> and start earning rewards today!</p>
        </div>
    </div>
</main>

<script>
    // Scroll event listener to add 'visible' class to boxes as they come into view
    window.addEventListener('scroll', function() {
        const boxes = document.querySelectorAll('.dynamic-box');
        const triggerBottom = window.innerHeight * 0.8; // Trigger when the box is 80% visible

        boxes.forEach(box => {
            const boxTop = box.getBoundingClientRect().top;
            const boxBottom = box.getBoundingClientRect().bottom;

            // Check if the box is in view
            if (boxTop < triggerBottom && boxBottom > 0) {
                if (!box.classList.contains('visible')) {
                    box.classList.add('visible'); // Add 'visible' class to trigger the animation
                    
                    // Add the glowing effect initially
                    box.classList.add('glowing');
                    
                    // Set timeout to remove the glow effect after 3 seconds
                    setTimeout(() => {
                        box.classList.remove('glowing'); // Remove the glowing class after 3 seconds
                    }, 3000); // 3000ms = 3 seconds
                }
            } else {
                box.classList.remove('visible'); // Remove 'visible' if not in view
            }
        });
    });

    // Handling form submission
    document.getElementById('primainForm').addEventListener('submit', function(event) {
        event.preventDefault();
        var primainName = document.getElementById('primainName').value;
        fetch('/', {
            method: 'POST',
            body: new URLSearchParams({ primain_name: primainName }),
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded'
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.redirect) {
                window.location.href = data.redirect; // Redirect to the display page
            } else if (data.error) {
                var messageContainer = document.getElementById('messageContainer');
                messageContainer.textContent = data.error;
                messageContainer.className = 'message danger';
                messageContainer.style.display = 'block';
            }
        })
        .catch(error => {
            var messageContainer = document.getElementById('messageContainer');
            messageContainer.textContent = 'An error occurred. Please try again.';
            messageContainer.className = 'message danger';
            messageContainer.style.display = 'block';
            console.error('Error:', error);
        });
    });
</script>
{% endblock %}
