{% extends "base.html" %}
{% block title %}Register New Primain{% endblock %}
{% block content %}
<header>
    <h1 id="h1">Register New Primain</h1>
</header>
<main>
    <form id="primain-form" method="POST">
        <div>
            <label for="primain_name">Desired Primain:</label>
            <input type="text" id="primain_name" style="width: 283px;" name="primain_name" placeholder="E.g. dog.tree.water" required>
            <span id="primain-status"></span> <!-- This will show checkmark or cross -->
            <span class="info-icon" id="primain-info">?</span>
            <div class="tooltip-text" id="primain-tooltip">A Primain is a unique identifier, like a domain name, e.g., dog.tree.water. The small checkmark/cross to the right will inform you about its availability.</div>
        </div> 
        <div class="field-with-button">
            <label for="chain">Blockchain Network:</label>
            <div class="custom-select-wrapper" style="width: 276px;"> <!-- Adjust width here -->
                <div class="custom-select">
                    <div class="custom-select-trigger">
                        <span>Select a Network</span>
                        <div class="arrow"></div>
                    </div>
                    <div class="custom-options"></div>
                </div>
            </div>
            <select id="chain" name="chain" style="display: none;"></select>
            <input type="hidden" id="chain_string" name="chain_string" required>
            <span class="info-icon" id="chain-info">?</span>
            <div class="tooltip-text" id="chain-tooltip">Select the blockchain network where your wallet's address is active. Be careful to select the right network as this will be the final symbol next to your Primain.</div>
        </div>
        
        <div class="field-with-button">
            <label for="address">Address:</label>
            <input type="text" id="address" name="address" placeholder="Enter your address" required>
            <button type="button" id="import-address" class="small-button">Import Address</button>
            <span class="info-icon" id="address-info">?</span>
            <div class="tooltip-text" id="address-tooltip">Your wallet address will be used to register the Primain on the selected blockchain. You can directly import it from your browser wallet.</div>
        </div>
        
        <div class="field-with-button">
            <label for="proof">Proof:</label>
            <input type="hidden" id="proof" name="proof" value="">
            <input type="text" style="width: 214px;" id="proof_display" name="proof_display" placeholder="Proof will be displayed here" readonly>
            <button type="button" id="sign-proof" class="small-button">Generate Proof</button>
            <span class="info-icon" id="proof-info">?</span>
            <div class="tooltip-text" id="proof-tooltip">The proof is a signature on your Primain registration data that verifies your ownership of the provided wallet's address.</div>
        </div>           
        <input type="hidden" id="signed_data" name="signed_data">
        <input type="hidden" id="payment-intent" name="payment_intent">  <!-- For payment intent -->
        <button type="submit" class="form-button">Proceed to Checkout</button>
    </form>
    <div id="mobile-message" class="mobile-message">Primain registration is currently only possible on Desktop environments</div>
</main>

<style>
    .mobile-message {
        display: none; /* Hide by default */
        background-color: #f8d7da; /* Light red background */
        color: #721c24; /* Dark red text */
        padding: 10px;
        margin: 10px 0;
        border: 1px solid #f5c6cb; /* Red border */
        border-radius: 5px;
        text-align: center;
        position: absolute; /* Positioning */
        top: 50%; /* Center vertically */
        left: 50%; /* Center horizontally */
        transform: translate(-50%, -50%); /* Adjust position */
        z-index: 999; /* Ensure it's on top */
    }

    @media (max-width: 768px) { /* Change 768px to your desired mobile breakpoint */
        .mobile-message {
            display: block; /* Show on mobile */
        }

        form {
            display: none; /* Hide the form when the mobile message is displayed */
        }
    }
</style>

<script src="https://js.stripe.com/v3/"></script> <!-- Include Stripe.js -->
<script src="https://unpkg.com/@solana/web3.js/dist/web3.min.js"></script>
<script src="https://unpkg.com/@walletconnect/client/dist/umd/index.min.js"></script>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        const mobileMessage = document.getElementById('mobile-message');

        if (window.innerWidth <= 768) { // Change 768 to your desired mobile breakpoint
            mobileMessage.style.display = 'block'; // Show mobile message
            document.getElementById('h1').style.display = 'none'; // Hide the form
        } else {
            mobileMessage.style.display = 'none'; // Hide if not mobile
            document.getElementById('h1').style.display = 'flex'; // Hide the form
        }

        // Optional: Adjust the message if the window is resized
        window.addEventListener('resize', function() {
            if (window.innerWidth <= 768) {
                mobileMessage.style.display = 'block';
                document.getElementById('primain-form').style.display = 'none'; // Hide the form
                document.getElementById('h1').style.display = 'none'; // Hide the form
            } else {
                mobileMessage.style.display = 'none';
                document.getElementById('primain-form').style.display = 'flex'; // Show the form
                document.getElementById('h1').style.display = 'flex'; // Hide the form
            }
        });
    });
</script>
{% endblock %}
